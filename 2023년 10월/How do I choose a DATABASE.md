# 어떤 데이터베이스를 선택해야 할까?

## 데이터베이스 - 왜 데이터베이스를 사용할까? 
데이터베이스는 엑셀을 떠올리면 된다. 데이터베이스의 가장 중요한 특성은 구조화된 데이터를 관리한다는 점이다.
'ID','비밀번호'처럼 컬럼에 따라 데이터를 정리하고, 어떠한 기준을 통해 데이터를 정렬하고 필터링할 수 있다.
굳이 엑셀을 사용하지 않고 데이터베이스를 쓰는 이유는 데이터베이스가 데이터를 추가/변경/삭제/조회하는 작업이 더 구조화되어 있고 빠르기 때문이다.  


데이터베이스는 수많은 형태와 종류가 존재한다. 형태로 치자면 RDB(관계형 데이터베이스) 와 NoSQL(Not only SQL)로 나눌 수 있고, 종류로 치자면 빅데이터 쿼리를 분산 처리하기 위해 개발된 PrestoDB, key-value 형태의 구조로 캐싱 용도로 자주 쓰이는 redis나 memcached, 시계열성 데이터를 저장하는 데에 특화되어 있는 InfluxDB같은 특별한 제품들이나 MySQL, PostgreSQL 등 전형적인 RDBMS가 있을 수 있다.

[(참고)](https://velog.io/@city7310/%EB%B0%B1%EC%97%94%EB%93%9C%EA%B0%80-%EC%9D%B4%EC%A0%95%EB%8F%84%EB%8A%94-%ED%95%B4%EC%A4%98%EC%95%BC-%ED%95%A8-10.-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%84%A0%EC%A0%95%EA%B3%BC-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%8B%9C%EC%9E%91)

나는 대부분 웹 서비스 운영을 위한 메인 데이터베이스를 결정하게 될 것이다. 그렇기 때문에 특별한 목적을 위해 만들어진 데이터베이스를 사용하진 않을 것이다.

## SQL vs NoSQL
그렇다면 SQL과 NoSQL의 차이는 무엇일까?

### SQL(RDB)
SQL은 관계형 데이터베이스(RDB)로써 이를 사용하면 RDBMS에 데이터를 저장, 수정, 삭제 및 검색할 수 있다.  
데이터는 테이블에 레코드(row)로 저장되며, 각 테이블마다 스키마가 존재한다.

따라서 스키마를 준수하지 않은 레코드는 테이블에 추가할 수 없다.  
왜냐하면 스키마를 준수하지 않으면 관계형이 아니기 때문이다.

<details>
<summary><b>스키마란?</b></summary>
<div markdown="1">       

스키마란 각 테이블마다 명확하게 정의된 구조를 뜻하는데 해당 구조는 필드의 이름과 데이터 유형으로 정의된다. 이러한 구조와 제약조건에 대한 정확한 명세를 스키마라고 부른다.

</div>
</details>

즉, <b>정해진 구조에 맞는 레코드만 추가가 가능한 것</b>이 SQL의 큰 특징이다.

RDB 특징
- 테이블마다 스키마를 정의
- 데이터는 정해진 스키마에 따라 테이블에 저장
- 데이터는 관계를 통해 여러 테이블에 분산
- 데이터 타입과 제약(Constraint)를 통해서 데이터의 정확성을 보장
- 성능을 높이려면 하드웨어를 고성능으로 교체
- 고성능 하드웨어는 비용이 많이 발생하기 때문에 확장에 제약이 있게되고 이로인해 확장성이 좋지 않음

### NoSQL
NoSQL은 RDB보다 일관성을 좀 더 내려놓고 확장성을 더 높여 데이터의 저장,수정,삭제,조회를 위한 메커니즘을 제공하기 위해 등장한 것이다.

따라서 NoSQL은 스키마도 존재하지 않고 관계도 없는 것이 특징이다.  
SQL에서 레코드에 해당하는 개념을 문서(document)로 저장하기 때문에 문서형 데이터베이스에 해당된다.

Non-RDB의 특징
- DB의 확장성의 제약을 해결하기 위해 등장
- 분산 컴퓨팅을 이용하여 상대적으로 더 낮은 비용으로 DB의 성능을 끌어 올릴 수 있음
- 스키마 없이 동작하며 관계도 없기에 하나의 거대한 단일 테이블로 구성
- NoSQL의 방식으로는 key-value, document, column-family, graph가 있음
- 구저에 대한 정의를 변경할 필요가 없어 필드를 추가하는 것이 자유로움
- 복잡한 SQL 쿼리문을 사용하지 않음
- 빅데이터 처리에 주로 사용

## 의사결정
여기까지 공부해봤을 때 내가 선택할 데이터베이스는 당연히 RDB이다. 그 이유는, 
- 내가 지금 단계에서 진행할 프로젝트는 규모가 클수가 없다. 그래서 굳이 스케일 아웃(접속된 서버의 대수를 늘려 처리 능력을 향상시키는 것)을 할 필요도 없다.  
- 평균적으로 NoSQL이 RDB보다 빠르고, 동일한 비용을 사용했을 때 웬만하면 NoSQL이 가성비가 좋다는데 이건 어떤 RDB 제품을 사용하느냐에 따라 다르다고한다.그리고 속도는 연습하는 나에게 별 상관이 없다.
- RDB에 대한 공부가 좀 더 되어있고, MySQL에 좀 더 익숙한 상황이다. 이에 대한 숙련도 먼저 길러놓고 다른 데이터베이스를 다뤄보자.

## 데이터베이스 설계 과정 중
데이터베이스 설계 과정 중 user_id에 대해 int를 쓸 것인가 bigint를 쓸 것인가 고민이 되었다.  
보통 id값이 43억이 넘어가는 아주 큰 DB를 사용한다면 고민없이 bigint형을 사용해야 한다고 한다.  
그렇지 않으면 보통 두 가지 요소를 고려해야 하는데

1. mysql의 메모리 용량, 서버 저장 공간, 쿼리 속도 등을 고려
- int형이 bigint형에 비해 10% 이상의 디스크 용량을 절약
- 수 십억개의 데이터를 가지지 않을 것이라면 속도 등 효율성 측면에서 int형을 사용할 것을 권장
2. 향우 업그레이드 용이성 고려
- DB 규모가 큰 어플리케이션 개발 시 서버 운영 효율이 낮아지더라도 bigint형으로 설정하는 것이 나을 수 있음
- 그 이유는 int형에서 bigint형으로 바꾸기가 너무 힘듦
- id의 경우 다른 테이블에서 외래키로 사용하고 있을 경우가 더러 존재하고 이미 int형을 bigint형으로의 변경을 고려할 정도라면 가지고 있는 데이터의 양이 많을 것이기 때문에 수정이 엄청 오래 걸림